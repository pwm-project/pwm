#
# Password Management Servlets (PWM)
# http://code.google.com/p/pwm/
#
# Copyright (c) 2006-2009 Novell, Inc.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#

#*******************************************************************************************#
#                              General Configuration                                        #
#*******************************************************************************************#
#
# General PWM behavior.  Most settings in this section will need to be changed.
#############################################################################################

#############################################################################################
# Name of the application, shows up on the default html header.  Localizable
#############################################################################################
title=Password Self Service

#############################################################################################
# List of ldap servers available to PWM in URL format.  Comma separated.
#
# These servers are used in order of appearance in this list.  If the first server
# is unavailable PWM will use the next available server in the list.  PWM will
# then periodically fail back to the first server to see if it has become available.
#
# For plain-text servers, use "ldap://serverame:389" format.
# For SSL, use the "ldaps://servername:636" format.
#
# Note also that for SSL, the JVM running PWM must trust the directory server,
# either because it has a valid commercial (Verisign) cert, or because you have
# manually added the public key certificate from the tree.  Alternatively,
# you can specify the ldapPromiscuusSSL setting.
#
# For Novell eDirectory, see Novell TID Document 10072075 for an overview of the certificate
# export/import process.
#############################################################################################
ldapServerURLs=ldaps://172.17.2.91:636

#############################################################################################
# Indicates if PWM should trust any SSL certificate even if it is not listed
# in the keystore.  This should never be enabled in production environment.
#############################################################################################
ldapPromiscuousSSL=true

#############################################################################################
# LDAP DN of user with rights to all users to be managed, in LDAP typeful syntax.
# This user must have rights to browse users, and manage password attributes on
# the user object.
#
# PWM uses this proxy user to perform all operations against the directory.
#
# Generally, the proxy user needs read/browse object rights to all user objects
# it will manage, as well as create object rights in the new user container (if
# enabled).
#
# the following attribute rights are required:
#
#    - compare/read attribute rights to all attributes
#    - Write attribute rights to the following:
#       - Object Class                  (objectClass)
#       - Password Management           (passwordManagement)
#       - pwm* attributes that are part of the pwmUser class (see pwmSchema.ldif)
#       - Locked By Intruder            (lockedByIntruder)
#       - Login Intruder Attempts       (loginIntruderAttempts)
#       - Login Intruder Reset Time     (loginIntruderResetTime)
#       - Login Grace Remaining         (loginGraceRemaingTime)
#       - Other attributes configured in this pwmServlet.properties file
#
#############################################################################################
ldapProxyDN=cn=admin,o=system

#############################################################################################
# The corresponding password of ldapProxyDN user.
#############################################################################################
ldapProxyPassword=n0v3ll

#############################################################################################
# Query string used to detect if a user is a pwmAdministrator.  An LDAP query is performed
# during pwm login against the logged in user to determine if the user is a pwm Admin.  If
# the user matches the query, then the user is considered a PWM administrator.
#
# Any attribute on the user entry is suitable for this check, including groupMembership.
#############################################################################################
pwmAdmin.queryMatch=(groupMembership=cn=pwmAdmins,ou=groups,o=utopia)

# If configured, this setting will add another field to the form-based PWM
# login screen.  The field will allow the user to select a specific context
# used during login.  This allows PWM to be used against trees that do not
# have unique usernames throughout.
#
# Values are separated with three semi-colons ";;;".  Values can further be set
# with both a display value and a context, separated by three colons ":::".
#
# For example:
#
# ou=sf,ou=ca,o=org:::San Francisco;;ou=lon,ou=uk,o=org:::London
#
# Any contexts here must be below the context specified in the
# ldapContextlessLoginRoot setting.
#
#############################################################################################
loginContexts=

#############################################################################################
# Timeout for ldap connections (in milliseconds).  If an LDAP server does not respond
# to a request within this time period it will be considered a failed server.
#############################################################################################
ldapTimeout=10000

#############################################################################################
# Base context to use for login and other operations
# pwm will not attempt any directory operations outside of this context.
#############################################################################################
ldapContextlessLoginRoot=ou=users,o=utopia

#############################################################################################
# URL to redirect user to upon logout.  If the site is being accessed through an iChain
# proxy server, the logout URL should be set to iChain's logout page.  This will be something
# like "http://www.novell.com/cmd/ICSLogout".
#
#          URL for iChain:  /cmd/ICSLogout
#  URL for Access Manager:  /AGLogout
#
# If you are using iChain/NAM and do not include the proper logout page here, then users will
# almost certainly get authentication errors, and intruder lockouts.  If it's working
# properly then the user should see the iChain logout screen when they logout of PWM.
#
# This url can be set to any desired relative or absolute URL.  At the time the user's
# browser requests this url, the PWM session will have already been invalidated.
#
# This setting can always be overridden for any given user session by adding a "logoutURL"
# parameter to any HTTP request during the session.
#############################################################################################
logoutURL=

#############################################################################################
# After completing operations which do not require a logout, the user will be forwarded to
# this url.
#
# This setting can always be overridden for any given user session by adding a "forwardURL"
# parameter to any HTTP request.
#############################################################################################
forwardURL=/pwm

#############################################################################################
# Force user to logout of PWM (and send to logoutURL) after a password change.
#
# In most cases, this should be left on the default, true, especially if using
# iChain.  However, some scenarios require that the user is not immediately
# logged out.
#############################################################################################
logoutAfterPasswordChange=true

#############################################################################################
# The path to the servlet's own context.  In most cases this should never be changed.
#############################################################################################
servletRelativeURL=/pwm

#############################################################################################
# smtp server address, any emails generated by PWM will be sent via this URL.
#
# Removing this setting will prevent PWM from sending any email at all.
#
# Be sure the server listed here allows relaying.  The default server will not work!  For
# best results, use a local smtp server.
#############################################################################################
smtpServerAddress=smtp.example.com

#############################################################################################
# If present, use the X-Forwarded-For HTTP header value as the client IP address instead of
# the source IP address of the connection.
#############################################################################################
useXForwardedForHeader=true


#############################################################################################
# Admin alert email address.  During certain events, PWM will send email notifications
# such events include things like intruder lockout events, or ldap server unavailability
#
# Leave this setting blank to disable the alerts.
#############################################################################################
adminAlertEmailAddress=

#############################################################################################
# Admin alert "From" email address.
#############################################################################################
adminAlertFromAddress=PWM Alert Notification <noreply@example.com>

#############################################################################################
# username search filter is used to for contextless login and other functions to find
# users in ldap using short values.  The literal value %USERNAME% is replaced with the
# actual username value.
#############################################################################################
usernameSearchFilter=(&(objectClass=person)(cn=%USERNAME%))

#############################################################################################
# Object classes to automatically add to users who authenticate to the password
# servlet.  Typically this is the standard pwmUser aux class.  The definition for this
# class is in the supplied pwmSchema.ldif file.
#############################################################################################
autoAddObjectClasses=pwmUser

#############################################################################################
# Number of seconds BEFORE a user's password expires in which to force the user to change
# their password.  If the user's password will expire within this time frame, PWM will behave
# as if the user's password has already expired.
#
# Setting this value to a day or so will prevent most cases of a user's password expiring
# while they are logged in.  The recommend setting for this value is 86400.
#
# 86400 = 1 day
#############################################################################################
expirePreTime=86400

#############################################################################################
# Number of seconds BEFORE a user's password expires in which to warn the user to change
# their password.  If the user's password will expire within this time frame, PWM will warn
# the user during a CommandServlet checkExpire or checkAll operation.
#
# If this time is zero or less than the expirePreTime, this feature will be disabled.
#
# 432000 = 5 days
#############################################################################################
expireWarnTime=432000

#############################################################################################
# When the user is authenticated to PWM, should there be a check to see if the user's
# password is expired (or about to expire based on the expirePreTime).  If this is set to
# true, and the user's password is expired, they will be forced to the expire password page.
#
#############################################################################################
expireCheckDuringAuth=true

#############################################################################################
# A comma separated list of java methods to call after a successful password change.  These
# methods may take such actions as updating passwords in other systems or updating
# eDirectory.  The full package name must be included.
#
# Unless your adding custom java code to PWM, you should leave this blank.
#############################################################################################
externalPasswordMethods=

#############################################################################################
# During a password change, PWM will wait for the password to be synchronized to all
# configured servers.  In cases where the synchronization may take an extraordinary amount of
# time, this setting will prevent the page from timing out.  Note that this functionality
# requires the pwmSchema.ldif be applied first.
#
# Value is measured in seconds.
#############################################################################################
passwordSyncMaxWaitTime=90

#############################################################################################
# When connecting to a Novell eDirectory ldap directory, this parameter will control if PWM
# will use NMAS extensions when connecting to the ldap directory.  Enabling nmas results in:
#
# * better error messages when using universal password policies
# * better error handling during certain change password scenarios
# * ability to read password during forgotten password recovery, preventing a random
#   password from being temporarily set on the user
#
# Unless you are using an older version of eDirectory (pre 8.8 or before), it is generally
# best to set this to true.
#############################################################################################
ldap.edirectory.enableNmas=true

#############################################################################################
# Always use proxy user account for ldap connections.  If true, PWM will only bind to
# the LDAP directory using the proxy username and password.  When set to true:
#
# - Authentication will be performed using ldap compare operation instead of bind
# - All read/write operations will require permission of the proxy user
# - Security is managed exclusively by PWM, any defects or "security holes" in pwm would
#   result in an exploitable security breach.
# - Password change operations are performed using the proxy user connection
# - User grace logins will not be decremented.
#
# The default setting is false.  You should carefully consider the security impacts before
# setting this to true.
#############################################################################################
ldap.edirectory.alwaysUseProxy=false

#############################################################################################
# If this setting is true, PWM will attempt to read the eDirectory password policy settings
# for the user.  If a universal password policy is configured and enabled, that policy will
# be read.  In cases where there is a conflict between the PWM configuration and eDirectory,
# the most restrictive policy will be used.
#############################################################################################
ldap.edirectory.readPasswordPolicies=true

#*******************************************************************************************#
#                                  Password Rules                                           #
#*******************************************************************************************#

#############################################################################################
# Query string used to detect if a user is a permitted to change password.  The user must be
# returned during this is ldap query or else the user will not be permitted to change the
# password.
#############################################################################################
password.allowChange.queryMatch=(objectClass=*)

#############################################################################################
# These remaining settings can be considered as global minimums for the
# password rules.  If 'password.readEdirectoryPasswordPolicy' is false, or the
# user has no universal password policy, then these rules will be used directly
# as they are configured here.
#
# Minimum length of password   A value of zero disables this check.
#############################################################################################
password.MinimumLength=2

#############################################################################################
# Maximum length of password.  A value of zero disables this check.
#############################################################################################
password.MaximumLength=64

#############################################################################################
# Maximum times any character may be repeated throughout the password.  Case is
# ignored for this check. A value of zero disables this check.
#############################################################################################
password.MaximumRepeat=0

#############################################################################################
# Maximum times any character may be sequentially repeated throughout the password.
# Case is ignored for this check.  A value of zero disables this check.
#############################################################################################
password.MaximumSequentialRepeat=0

#############################################################################################
# Allow numeric characters in password
#############################################################################################
password.AllowNumeric=true

#############################################################################################
# Allow the first character to be numeric (if numeric allowed).
#############################################################################################
password.AllowFirstCharNumeric=true

#############################################################################################
# Allow the last character to be numeric (if numeric allowed).
#############################################################################################
password.AllowLastCharNumeric=true

#############################################################################################
# Minimum amount of numeric characters required (if numeric allowed).  A value of zero
# disables this check.
#############################################################################################
password.MinimumNumeric=0

#############################################################################################
# Maximum amount of numeric characters required (if numeric allowed).  A value of zero
# disables this check.
#############################################################################################
password.MaximumNumeric=0

#############################################################################################
# Allow special (non alpha-numeric) characters in password
#############################################################################################
password.AllowSpecial=true

#############################################################################################
# Allow the first character to be special (if special allowed).
#############################################################################################
password.AllowFirstCharSpecial=true

#############################################################################################
# Allow the last character to be special (if special allowed).
#############################################################################################
password.AllowLastCharSpecial=true

#############################################################################################
# Minimum amount of special characters required (if special allowed).  A value of zero
# disables this check.
#############################################################################################
password.MinimumSpecial=0

#############################################################################################
# Maximum amount of special characters allowed (if special allowed).  A value of zero
# disables this check.
#############################################################################################
password.MaximumSpecial=0

#############################################################################################
# Minimum amount of alpha characters required.  A value of zero disables this check.
#############################################################################################
password.MinimumAlpha=0

#############################################################################################
# Maximum amount of alpha characters required.  A value of zero disables this check.
#############################################################################################
password.MaximumAlpha=0

#############################################################################################
# Minimum amount of lower case characters required.  A value of zero disables this check.
#############################################################################################
password.MinimumLowerCase=0

#############################################################################################
# Maximum amount of lower case characters required.  A value of zero disables this check.
#############################################################################################
password.MaximumLowerCase=0

#############################################################################################
# Minimum amount of upper case characters required.  A value of zero disables this check.
#############################################################################################
password.MinimumUpperCase=0

#############################################################################################
# Maximum amount of upper case characters required.  A value of zero disables this check.
#############################################################################################
password.MaximumUpperCase=0

#############################################################################################
# Minimum amount of unique characters allowed.  A value of zero disables this check.
#############################################################################################
password.MinimumUnique=0

#############################################################################################
# Maximum amount of passwords from the old password allowed.  A value of zero disables this
# check.
#############################################################################################
password.MaximumOldPasswordChars=0

#############################################################################################
# Enforce MS-ActiveDirectory style password complexity rules:
# - Not contain the user's account name or parts of the user's full name that exceed two
#     consecutive characters
# - Be at least six characters in length
# - Contain characters from three of the following four categories:
#   - English uppercase characters (A through Z)
#   - English lowercase characters (a through z)
#   - Base 10 digits (0 through 9)
#   - Non-alphabetic characters (for example, !, $, #, %)
#
#############################################################################################
password.ADComplexity=false

#############################################################################################
# A Regular Expression pattern the password must match in order to be allowed.  Multiple
# patterns can be listed by separating with three semi-colons ";;;".   Patterns must
# follow the rules listed at:
#
# http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html
#############################################################################################
password.RegExMatch=

#############################################################################################
# A Regular Expression pattern the password must not match in order to be allowed.  Multiple
# patterns can be listed by separating with three semi-colons ";;;".   Patterns must
# follow the rules listed at:
#
# http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html
#############################################################################################
password.RegExNoMatch=^.*&.*$

#############################################################################################
# PWM supports full dictionary checking to prevent users from using commonly used words as
# passwords.   The default wordlist contains commonly used English passwords.  A more
# comprehensive wordlist is available on the PWM project page.  Additionally, a custom
# wordlist can be used.  Wordlists with over 10 million words are supported.
#
# The first time PWM is run with a new wordlist setting, it will take awhile to compile
# the wordlist into a database.  See the status screen/logs for progress information.
#
# The wordlist format is one or more text files containing a single word per line, enclosed
# in a ZIP file.
#
# Setting this to blank will disable wordlist (dictionary) checking.
#############################################################################################
password.WordlistFile=wordlist.zip

#############################################################################################
# PWM can generate "freindly" random password suggestions to users.  It does this by using
# a "seed" word or words, and then modifying that word randomly until it is suffeciently
# complex and meets the configured rules computed for the user.
#
# Setting this to blank will result in suggested passwords being completely randomized.
#############################################################################################
password.SeedlistFile=seedlist.zip

#############################################################################################
# After a user password change, PWM will store a user's old password in the shared history
# list.  The shared history list will then be used during new password creations, and users
# will not be permitted to use a password stored there.  Passwords are stored as salted
# hashes in the pwmDB.
#
# This has the effect of producing a common, shared password history for all PWM users.  Old
# passwords are added to the history at the time of password change.
#
# Passwords are stored as a salted hash.
#
# Setting this to zero will disable the shared history.
#
# PWM will periodically remove values older than the configured value here.  Value is
# specified in seconds.  Default is 4 weeks (60s * 60m * 24h * 7d * 4w = 2419200)
#############################################################################################
password.sharedHistory.age=2419200

#############################################################################################
# A list of values not allowed to be used as passwords (case insensitive).  This list
# is essentially treated the same as the wordlistfile.  Multiple values are separated
# with three semi-colons (";;;").
#############################################################################################
password.disallowedValues=

#############################################################################################
# A comma separated list of attributes that are not allowed to be used in the user's
# password
#############################################################################################
password.disallowedAttributes=cn,givenName,sn

#############################################################################################
# This attribute is used to mark when the password is updated, and is used during
# replication checks, and other processes.
#############################################################################################
passwordLastUpdateAttribute=pwmLastPwdUpdate

#*******************************************************************************************#
#                               Intruder Detection                                          #
#*******************************************************************************************#
#
# PWM has built in intruder detection independent of what eDirectory itself
# provides.  Because PWM may be exposed directly to the internet, this additional
# layer of detection safeguards against direct attacks.  PWM will always deny a
# password based authentication if eDirectory's intruder detection is evaded.
#
# PWM's own intruder detection mechanisms are only stored in memory, and are not resetable,
# thus, the timeouts should be relatively short.  The goal for PWM intruder detection isn't
# to watch for human intruders, it is designed to stop robot or automatic attacks.
#############################################################################################

#############################################################################################
# This setting defines the time period after which a bad attempt will be cleared from
# the lockout table.  The user lockout table is marked for a user anytime a user has
# a failed attempt to authenticate, recover a password, or activate a user account.
#
# Value is in number of seconds.  A value of zero disables the user lockout table.
#############################################################################################
intruder.user.resetTime=300

#############################################################################################
# The maximum number of attempts a user may make within the reset time interval.  Once
# this value is exceeded, the user will not be able to perform any PWM activities until
# the reset time interval has passed.
#############################################################################################
intruder.user.maxAttempts=10

#############################################################################################
# This setting defines the time period after which a bad attempt will be cleared from
# the lockout table.  The address lockout table is marked for any source ip address
# anytime any user has a failed attempt to authenticate, recover a password, or activate
# a user account from that address.
#
# Depending on how PWM is deployed it may not be able to correctly identify the IP address
# of the user.  You can check if it is getting the correct IP address by looking at
# the light text on the bottom of every screen, or by looking at the PWM logs.
#
# Some scenarios where PWM would not get the correct address is where it is behind
# a reverse proxy that doesn't set the X-Forwarded-For header, or behind some types
# of NAT firewalls.
#
# Value is in number of seconds.  A value of zero disables the address lockout table.
#############################################################################################
intruder.address.resetTime=120

#############################################################################################
# The maximum number of attempts any user may make within a particular address.  Once
# this value is exceeded, no user from that address will be able to perform any PWM
# activities until the reset time interval has passed.
#############################################################################################
intruder.address.maxAttempts=30

#############################################################################################
# The maximum number of attempts any user may make during a particular browser session.
# Once this limit is exceeded, it will never reset.  Opening a new browser or waiting for
# the session idle timeout will get the new user a new session, however.
#############################################################################################
intruder.session.maxAttempts=5

#*******************************************************************************************#
#                                  Event Logging                                            #
#*******************************************************************************************#

#############################################################################################
# Maximum log events stored in pwmDB.  PWM will retain this number of events in the local
# pwmDB database and use these to display in the admin event log screen.
#
# This setting does not effect the normal log files configured in log4jconfig.xml or
# tomcat's log file settings.
#
# Approximately 100MB of disk space will be consumed for each 100,000 log events
#############################################################################################
eventLog.localDbMaxEvents=1000000

#############################################################################################
# Maximum age of events stored in pwmDB.  PWM will evict events older than this from the
# pwmDB database.  This setting is related to "eventLog.localDbMaxEvents".  Events will be
# evicted by whichever condition occurs first.
#
# This setting does not effect the normal log files configured in log4jconfig.xml or
# tomcat's log file settings.
#
# PWM will periodically remove values older than the configured value here.  Value is
# specified in seconds.  Default is 4 weeks (60s * 60m * 24h * 7d * 4w = 2419200).  A value
# of zero will cause PWM to not remove events due to age.
#############################################################################################
eventLog.localDbMaxAge=2419200

#############################################################################################
# Attribute used to write a user event log.  The user event log attribute will
# hold an XML document with the users pwm Event history.  Leave blank to disable
# logging event history to ldap.
#############################################################################################
eventLog.userAttribute=pwmEventLog

#############################################################################################
# Maximum number of events to hold in the event log for a user.
#############################################################################################
eventLog.maxEvents=20

#*******************************************************************************************#
#                                Password Change Email                                      #
#*******************************************************************************************#

#############################################################################################
# Change password email notification (if this line is blank, no email will be sent on
# password change)
#
# Localizable.
#############################################################################################
password.emailSubject=Password Change Notification

#############################################################################################
# change password email from address
#
# Localizable.
#############################################################################################
password.emailFrom=PWM Notification Agent <noreply@example.com>

#############################################################################################
# change password mail body.
#
# Use "\n" for a line feed,
#
# Localizable.
#############################################################################################
password.emailBody=\
  Notice: Your password has been changed.\n\
  \n\
  If you initiated this change, no action is required.  If you did not initiate this change,\n\
  you should contact your helpdesk immediately.\n\

#*******************************************************************************************#
#                                  Password Recovery                                        #
#*******************************************************************************************#
#                                                                                           #
# Note: If password.readEdirectoryPasswordPolicy is set to true, and there is a             #
# configured challenge set for the user's assigned password policy, that challenge          #
# set will be used instead of those configured in this file.                                #
#############################################################################################

#############################################################################################
# Query string used to detect if a user is a permitted to configure challenges.  The user
# must be returned during this is ldap query or else the user will not be permitted to
# configure challenges.
#############################################################################################
challenge.allowSetup.queryMatch=(objectClass=*)

#############################################################################################
# If true, the user will be directed to configure challenge/response before loging out of PWM.
# This accounts for new user creation and activation, and other scenarios.  The user is
# forced check to see if eligible for allowSetup, and also if they do not have valid
# responses already configured.
#############################################################################################
challenge.forceSetup=true

##############################################################################################
# Required Challenge Questions.  Separate multiple questions with ";;;".
#
# The user is required to answer all required questions during both response setup and
# password recovery
#
# Localizable.
#############################################################################################
challenge.requiredQuestions=What is your maiden name?:::5:::200;;;What is your fathers middle name?

##############################################################################################
# Required ldap attributes for challenge/response.  These attributes will be required to
# be supplied by the user as part of the forgotten password mechanism.   The proxy user
# will require "compare" ldap rights to these attributes.
#
# Localizable.
#############################################################################################
challenge.requiredAttributes=sn:Surname:str:2:100:true:false

#############################################################################################
# Random Secret Questions.  Separate multiple questions with ";;;".
#
# The user is required to answer all random questions during setup responses, but only the
# minRandomRequired amount during recovery
#
# Localizable.
#############################################################################################
challenge.randomQuestions=%user%;;;What is your favorite cartoon?;;;What is your favorite food?

#############################################################################################
# Minimum number of random questions required
#
# Localizable.
#############################################################################################
challenge.minRandomRequired=2

#############################################################################################
# Attribute to use for secret question storage (on the ldap user object)
#############################################################################################
challenge.userAttribute=pwmResponseSet

#############################################################################################
# Random question style.  Determines how random questions are handled.
#
# RECOVER
#    Allow selection of random passwords at time of password recovery.  During
#    setup of responses, all random responses must be supplied.
#
# SETUP (default)
#    Allow the user to input only the number of required randoms at time of
#    response setup.  During recovery, only the minimum number of responses need to
#    be supplied.  If SETUP mode is used, and the user does not have any user supplied
#    questions, then PWM will use select (drop down) lists for challenge selection.
#
#############################################################################################
challenge.randomStyle=SETUP

#############################################################################################
# Allow unlock during forgotten password.  If true, and if the user's account is locked
# due to too many invalid login attempts, and the user's password is not expired, then the
# user will be given a chance to unlock their account instead of resetting their password.
#############################################################################################
challenge.allowUnlock=true

#############################################################################################
# Method used to store user's responses.  See the admin guide for details.
#
# Available Options:
#
# PWMTEXT
# PWMSHA1
# PWMSHA1+NMAS (default)
# PWMTEXT+NMAS
#
#############################################################################################
challenge.storageMethod=PWMSHA1+NMAS

#############################################################################################
# Which method is used to manage the user's challenge questions.  Keep in mind
# that only PWM policies allow for internationalization.
#
# Available Options:
#
# PWM                  Policies stored in pwm config files
# NMAS                 Policies stored in universal password policy files
# NMAS+PWM (default)   NMAS if available, otherwise PWM
#
#############################################################################################
challenge.policyMethod=NMAS+PWM

#############################################################################################
# Control the case sensitivity of responses.  If marked true, then responses
# will be deemed correct even if case is wrong.  Changing this value does not
# change existing stored responses -- the case sensitive flag is saved on each
# user's stored response.
#############################################################################################
challenge.caseInsensitive=true

#############################################################################################
# Show the responses to the user after they configure them.  This will give your users an
# opportunity to read and review their responses before submitting, however it will show
# the responses on the screen and make them visible to anyone else watching the users
# screen.
#############################################################################################
challenge.showConfirmation=true

#############################################################################################
# Control if each response is required to be unique
#############################################################################################
challenge.allowDuplicateResponses=false

##############################################################################################
# Prevent commonly used words from being used as responses.  If true, and a wordlist is
# configured, then users will not be able to use response values that are in the wordlist
#############################################################################################
challenge.applyWorldlist=false


#*******************************************************************************************#
#                               New User Registration                                       #
#*******************************************************************************************#
#                                                                                           #
# Note: The new user registration module requires that the proxy user has sufficient rights #
# to create users and, if so configured, to check for duplicate values.                     #
#############################################################################################


#############################################################################################
# Enable new user registration
#############################################################################################
newUser.enable=true

#############################################################################################
# Context new users will be created in context.
#############################################################################################
newUser.createContext=ou=pwm,o=utopia

#############################################################################################
# Attributes that must be unique in the directory for the user to be created.  For example,
# if the 'mail' attribute is listed here (and is in the newUser.attributes setting), then PWM
# will not allow the new user to be created if the value for the mail attribute already
# exists on any other user object.  This would result in all userIDs having unique email
# addresses.
#############################################################################################
newUser.creationUniqueAttributes=cn,mail

#############################################################################################
# writes attributes to ldap after a user is activated.  These attributes will be written
# to the user object just after creating the object.
#
# format is name=value pair, multiple attributes can be specified by separating with a comma.
#############################################################################################
newUser.writeAttributes=description=PWM Created User

#############################################################################################
# New User form creation attributes/fields.
#
# See the end of this file for a complete description of this syntax.
#
# The values for cn and sn are required by eDirectory, so they must be included
# here as well.
#
# See the end of this file for a description of the syntax for this setting.
#
# Example: cn:Username:str:4:10:true:false,sn:Last Name:str:1:10:true:false
#
# Localizable.
#############################################################################################
newUser.attributes=cn:Username:str:2:10:true:false,givenName:First name:str:4:40:true:false,sn:Last name:str:4:40:true:false,mail:Email Address:email:3:50:true:true,telephoneNumber:Telephone Number

#*******************************************************************************************#
#                                 New User Email                                            #
#*******************************************************************************************#

#############################################################################################
# new user email subject
#
# Localizable.
#############################################################################################
newUser.emailSubject=Welcome

#############################################################################################
# new user email from address
#
# Localizable.
#############################################################################################
newUser.emailFrom=Password Notification Agent <noreply@example.com>

#############################################################################################
# new user email body, suggest include information about what to do if this wasn't the user
# that registered.
#
# Localizable.
#############################################################################################
newUser.emailBody=Thank you for registering.

#*******************************************************************************************#
#                                User Activation                                            #
#*******************************************************************************************#

#############################################################################################
# activateUser module is enabled
#############################################################################################
activateUser.enable=true

#############################################################################################
# Form fields for activate user module.
#
# See the end of this file for a description of the syntax for this setting.
#
# localizable.
#############################################################################################
activateUser.attributes=cn:Username:str:2:10:true:false,sn:Last Name:str:2:32:true:false

#############################################################################################
# Search filter used to find user during user activation.  If present in the search filter,
# strings enclodes with a percent sign (%) will be replaced with values accrding to the
# configured form fields.
#############################################################################################
activateUser.searchFilter=(&(objectClass=person)(cn=%cn%))

#############################################################################################
# only allow users who match this query to be activated.  Generally, you will
# only allow users who's accounts are disabled and have not been previously activated
# to be activated.  The default example uses the "vehicleInformation" attribute on
# the user object because it is a rarely used attribute available in the default
# schema, but any attribute can be used for this.
#############################################################################################
activateUser.queryMatch=(&(loginDisabled=true)(!(vehicleInformation=pwmActivated)))

#############################################################################################
# writes attributes to ldap after a user is activated.  Typically this is
# used to activate the account, as well as put some searchable indicator
#
# format is name=value pair, multiple attributes can be specified by separating with a comma.
#############################################################################################
activateUser.writeAttributes=vehicleInformation=pwmActivated,loginDisabled=false

#*******************************************************************************************#
#                                Update Attributes                                          #
#*******************************************************************************************#
#
# The update user attributes module will force the user to update the attributes
# configured here.  This is useful for forcing the user to populate to update some
# piece of information while they are using PWM.
#############################################################################################

#############################################################################################
# activateUser module is enabled
#############################################################################################
updateAttributes.enable=true

#############################################################################################
# Form fields for update attributes.
#
# See the end of this file for a description of the syntax for this setting.
#
# localizable.
#############################################################################################
updateAttributes.attributes=telephoneNumber:Telephone Number:str:3:15:true:false,title:Title:str:2:15:true:false

#############################################################################################
# writes attributes to ldap after a users attributes are populated.  Typically
# this is used to put some searchable indicator on the user object.
#
# format is name=value pair, multiple attributes can be specified by separating with a comma.
#############################################################################################
updateAttributes.writeAttributes=vehicleInformation=pwmUpdated

#*******************************************************************************************#
#                                Command Functions                                          #
#*******************************************************************************************#

#############################################################################################
# if the command servlet is called with the checkIfResponseConfigNeeded command:
#
# /pwm/private/CommandServlet?command=checkIfResponseConfigNeeded
#
# the user is first checked to see if they match the following LDAP query before the
# user's password responses is checked.  If the user does not match this query, then the
# user's responses will not be checked, and the user will be redirected to the forward URL.
#############################################################################################
command.checkResponses.queryMatch=(objectClass=*)

#############################################################################################
# On certain configuration options, multiple attributes used for building complex UI forms
# can be set. For such attributes, the following syntax can be used for each form field:
#
# attributeName:label:type:minimumLength;maximumLength;required:confirm
#
# where:
#
# attributeName - Name of ldap attribute
# label         - Label to show to user (in error messages)
# type	        - One of the following strings:
#                   * int - interger value
#                   * str - normal string (default)
#                   * email - normal string with email validation
#                   * password - requires password validation
# minimumLength	- Minimum length
# maximumLength	- Maximum length
# required	    - Parameter is required (true/false)
# confirm	    - Parameter requires confirmation (true/false) (requires an additional
#                 value_confirm parameter on the form)
#
# Example: givenName:First Name:str:1:40:true:false
#############################################################################################


#*******************************************************************************************#
#                                Shortcut Settings                                          #
#*******************************************************************************************#
#
# Useful for presenting a simple shortcut or "landing" page for end users.
#############################################################################################

#############################################################################################
# Query-based shortcut.  If a user matches this shortcut, they will be presented a link.
#
# the format for this setting is:
#
# ldap-query;;;url;;;label;;;description
#
# where:
#
# ldap-query    - Valid ldap syntax style query, if the user matches this query, then the
#                 shortcut will be shown to the user.
# url           - http url that the shortcut will be displayed for
# label         - short description of the shortcut
# description   - long description of the shortcut
#
# For example the setting "(cn=js*);;;http://wwww.novell.com;;;Novell" will show a link to
# the Novell home page for users who's cn starts with 'js'.
#
# Settings from of 1-100 are permitted as 'shortcut.query.1, shortcut.query.2' and so on.
#
# Localizable.
#############################################################################################
shortcut.query.1=(objectClass=inetOrgPerson);;;http://www.google.com;;;Google;;;Google Search
shortcut.query.2=(&(objectClass=inetOrgPerson)(cn=n*));;;http://www.novell.com;;;Novell;;;Novell Home Page
shortcut.query.3=(objectClass=inetOrgPerson);;;http://www.yahoo.com;;;Yahoo;;;Yahoo Home Page


#*******************************************************************************************#
#                                 Captcha Settings                                          #
#*******************************************************************************************#
#
# Display a captcha to prevent automated attacks against public modules.  Pwm uses an
# implementation of reCaptcha.  ReCaptcha info can be found at http://recaptcha.net/
#
# Registration at the reCaptcha sight will provide a public and private key which must
# be configured here for reCaptcha support.  Additionally, the PWM servlet will need to
# be able to make HTTP requests to http://api-verify.recaptcha.net/verify during operation
# or captcha verification will fail.
#
# If blank no captcha verification will be performed.
#
#############################################################################################
captcha.recaptcha.publicKey=
captcha.recaptcha.privateKey=

#############################################################################################
# Allows for skipping the captcha request if a known parameter is passed as a request
# paramater with a key of "skipCaptcha".   This is useful for "internal" clients /
# links where the captcha is unnecessary.
#
# For example, if the value is 'okay', a request to:
#   https://pwmserver.example.com/pwm/public/ForgottenPassword?skipCaptcha=okay
# would cause PWM to skip the captcha check.
#############################################################################################
captcha.skip.param=

#############################################################################################
# Allows for skipping the captcha request if a known browser cookie value is held by the
# browser the cookie is stored in a cookie named 'pwm-captcha-key'.  If the value is correct,
# then the captcha check is skipped.  The cookie value is stored in the browser after a
# successful captcha check.  
#
# If blank, then no cookie will be read/stored.  If set to 'instanceID', then the instanceID
# of pwm (see web.xml instanceID setting) will be used.  If set to any other value, then
# the literal value will be used.
#############################################################################################
captcha.skip.cookie=instanceID

#******************************************************************************************#
#                                     END OF FILE                                           #
#*******************************************************************************************#
